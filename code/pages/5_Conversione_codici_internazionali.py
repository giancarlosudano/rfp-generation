import streamlit as st
import os
import traceback
from datetime import datetime
import pandas as pd
from langchain_openai import AzureChatOpenAI
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser
from langchain_community.callbacks import StreamlitCallbackHandler
import xml.etree.ElementTree as ET
from dotenv import load_dotenv
import base64
import datetime
import glob
import json
import openai
import os
import requests
import sys
import re

def similarity(ragione_sociale:str, container_stream):
	input = f"""Cerca all'interno della tabella delimitata da ### le voci più simili per sintassi, assonanza e in ultima analisi profilo a questa ragione sociale:
{ragione_sociale}

###
Codice	Ragione Sociale
057188	OMYA GMBH
057410	4 EMME ITALIA SRL
057434	A.C.P. INDUSTRIES
035758	A.I.A.-AGRICOLA ITALIANA ALIMENTARE S.P.A.
057407	A.L.F. SRL
051694	A.M.A. SPA
049713	A.T.L. ADRIATICA TECNO LOGISTICA SRL
057131	A2A TRADING S.R.L.
030066	AAE AHAUS ALSTATTER EISENBAHN CARGO AG
027355	ACCIAI DI QUALITA` SPA
018266	ACCIAI SPECIALI TERNI SPA CON SOCIO UNICO
018289	ACCIAI SPECIALI TERNI SRL - STAB. TERNI
020827	ACCIAI SPECIALI TERNI SRL - STAB. TERNI
028384	ACCIAI TUBI SPA
005032	ACCIAIERIA ARVEDI S.P.A.
011051	ACCIAIERIE BERTOLI SAFAU SPA
057355	ACCIAIERIE D ITALIA S.P.A.
057262	ACCIAIERIE DI VERONA S.P.A.
057251	ACCIAIERIE E FERRIERE DI PIOMBINO SPA
031114	ACCIAIERIE VENETE S.P.A.
011411	ACCIAIERIE VENETE SPA
012705	ACQUA MINERALE S. BENEDETTO S.P.A.
031017	ADRIA EST S.P.A
054218	ADRIAFER SRL
052975	ADRIATICA S.P.A.
056886	ADRIATICA S.P.A.
057303	ADVANCED TRANSPORT SOLUTION SRL
002103	AFV ACCIAIERIE BELTRAME SPA
057210	AGENZIA MARITTIMA PONS LTD SRL
048983	AGIT
057432	AGRI-CER BARIN S.N.C.
004156	AGRICOM SAS DI CAMINO S. & C.
057365	AGRINORD S.A.S.
005660	AGRISERVICE SRL
053966	AGRO FREIGHT- SPEDITION GMBH
038749	AGROHANDEL GMBH -294 629-
057418	AGROPODNIK A.S. TRNAVA
013070	ALESSANDRO BILLITZ SUCC. SRL
003606	ALESSIO TUBI SPA
011246	ALFA ACCIAI SPA
041945	ALFA TRANS SRL
018468	ALPE ADRIA S.P.A.
003660	ALSTOM FERROVIARIA S.P.A.
057414	ALTEKSKEM D.O.O.
005903	ALTUGLAS SRL SOCIO UNICO
030522	ALTUGLAS SRL SOCIO UNICO
036354	ALTUGLAS SRL SOCIO UNICO
057426	AMBER S.R.L.
057114	AMBROGIO S.A.
012709	AMBROGIO TRASPORTI SPA
054137	AMBROGIO TRASPORTI SPA
003802	AMBROGIO TRASPORTI SPA
054752	AMENDOLA SRL TRASPORTI E LOGISTICA
057145	AMEROPA A.G.
057243	ANCONA NEWPORT SCARL
035306	ANDRIULO LUCIO
054229	ANGELO GABRIELLI SRL
054798	ANSALDO BREDA S.P.A.
057429	APERAM CHATELET STAINLESS BELGIUM NV/SA
057334	APERAM STAINLESS SERVICES ET SOLUTIONS ITALY
053646	ARCELOR
033054	ARCELOR LONG COMMERCIAL TORINO SRL
053848	ARCELOR MITTAL DISTRIBUZIONE ITALIA S.R.L.
053549	ARCELOR PURCHASING
011868	ARCELORMITTAL LOGISTICS ITALIA SRL
005023	ARCELORMITTAL PIOMBINO SPA
057318	ARCELORMITTAL POLAND SPOLKA AKCYJNA
056278	ARCELORMITTAL STEEL HAMBURG GMBH
056169	ARCESE TRASPORTI S.P.A.
011563	AREAGAS SRL
001827	ARIENTI TRASPORTI FERROVIARI S.P.A.
044105	ARKEMA
040755	ARMAFER SRL
043382	ARS ALTMANN AG-AUTOMOBILLOGISTIK
023641	ARVEDI TUBI ACCIAIO SPA
057192	ASCO INDUSTRIES
057192	ASCO INDUSTRIES
057501	ASCOSERVICE AG
038267	ASOTRA -INTERNATIONALE SPEDITIONS UND TRANSPORTGESELLSCHAFT
005999	ASTOLFO DI DAMETTO SRL
056958	ATAC S.P.A.
022768	ATG AUTOTRANSPORT LOGISTIC GMBH -P.IVA.ESTERA DE113827492-
057399	ATIR-RAIL GESTION SAS
050450	ATM AZIENDA TRASPORTI MILANESI
005496	ATTILIO CARMAGNANI S.P.A.
012525	AUTAMAROCCHI S.P.A.
010801	AUTOGAS NORD SPA
015901	AUTOMAR SPA
057063	AUTOSPED G S.P.A.
053655	AUTOSTRADA FERROVIARIA ALPINA SRL
025570	AUTOTRASPORTI AIROLDI ARDUINO SAS DI DOZIO MARIA ROSA & C.
057032	AUTOTRASPORTI CESTARO G. S.r.l.
042410	AUTOTRASPORTI LOCATELLI SNC
020872	AUTOTRASPORTI SERGIO SANTOSUOSSO S.R.L.
057202	AWT CECHOFRACHT
057278	AZIENDA SERVIZI TRASPORTI LOGISTICA S.R.L.
018399	B.M.I. SPA
057421	B.O.S. SRL
057319	B.V.S. SRL
042659	BAGGIO S.P.A. TRASPORTI
004289	BALADDA ALFREDO LEGNAMI
057512	BALKAN SANDS AND CLAY
057186	BAMERT HEINZ TRASPORT AG
018939	BANDINELLI SPA
026881	BARACLIT SPA
043552	BARILLA G. & R. F.LLI S.P.A.
028870	BASALTI ORVIETO
038187	BASELL POLIOLEFINE ITALIA S.R.L.
038262	BASELL POLIOLEFINE ITALIA S.R.L.
012088	BATTAZZA SPA
056779	BB BARI SRL
057378	BCUBE CONNECT SRL
057148	BCUBE SPA
021203	BENASSO LAVARELLO SA
057400	BERGER LOGISTIK GMBH
051623	BERTANI SERVIZI FERROVIARI SRL
011301	BERTANI TRASPORTI SPA
005723	BERTUOLA RENATO
057478	BIOMASSE SICILIA SPA
013184	BIPAN SPA
057012	BIRRA CASTELLO S.P.A.
011991	BIT SPA
056705	BLG AUTORAIL GMBH
049687	BLS CARGO SA
042689	BLU FILM S.R.L.
054443	BOLOGNA PONENTE SCARL
057389	BOMBARDIER TRANSPORTATION GMBH
051703	BOMBARDIER TRANSPORTATION ITALY S.P.A
053842	BONOTTO SRL
053742	BORIANI NAVIGAZIONE SRL
057483	BORSARI 1954 S.R.L.
029115	BORSARI E & C. S.R.L.
056737	BORSARI LOGISTIC S.
008033	BORSARI SPA
057122	BOURGOGNE FRET SERVICES
034365	BRAMBILLA SCALO
009594	BRAMBILLA SCALO
015864	BRAMBILLA SCALO SRL
057499	BRUENING GROUP DANMARK APS
051640	BUNGE ITALIA S.P.A.
002162	BUNGE ITALIA S.P.A.
053131	BURGO ARDENNES SA
008591	BURGO GROUP S.P.A.
056896	BURGO GROUP S.P.A.
044846	BUZZI UNICEM SPA
057513	BUZZI UNICEM SRL
053096	C.E.T.A.L. SRL
029501	C.H. SCHOLZ KG -6585-
019037	C.I.O. - COOP. IMBALLAGGI ORTOFRUTTICOLI
057482	C.RO PORTS NEDERLAND BV
053676	C.S.L. Scarl./STABILIMENTO ULIVETO
056975	C.S.L. Scarl./STABILIMENTO ULIVETO
056760	C.STEINWEG û GMT SRL
057406	C.U.BE ECOLOGIA SRL
040775	CA` D`ORO SPA
057280	CAF CONSTRUCCIONES Y AUXILIAR DE FERROCARRILES, S.A.
056273	CAL.ME. S.P.A.
015919	CALEOTTO SPA
026173	CAPRIMETAL SRL
056792	CAPTRAIN ITALIA SRL
057309	CAPTRAIN POLSKA SP. Z.O.O.
054928	CAPTRANSLOGISTICS S.R.L.
057235	CARBONES HOLDING GMBH
035921	CARGILL SRL
052989	CARGO CLAY S.R.L.
057211	CARGO SERVICE GMBH
054763	CARGOFER SRL
005984	CARLESSO DINO
055251	CARLO MINAFRO & C SNC
057461	CARMAGNANI ATTILIO AC SPA
056065	CARMINATI DISTRIBUZIONE SRL
011784	CARMINATI SIDERURGICA SPA
002831	CARTIERE DEL GARDA
020765	CARTIERE DEL GARDA SPA
044617	CASA OLEARIA ITALIANA SPA
056073	CASTALDO S.P.A.
013574	CASTALDO SRL
057062	CATONE SPA
054786	CATURANO AUTOTRASPORTI S.R.L.
057258	CD CARGO - CD GENERALVERTRETUNG WIEN GMBH
057312	CD CARGO A.S.
057412	CD CARGO LOGISTICS A.S.
057299	CD LOGISTICS
034931	CECI SIDERURGICA SRL
057254	CEFALU 20 SCARL
057476	CEFETRA SPA
054703	CELERTRASPORTI S.R.L.
043993	CEMENTERIA COSTANTINOPOLI SRL
047894	CENTRO SIDERURGICO BRESCIANO SPA
011036	CEPIM SPA
056718	CEREAL DOCKS INTERNATIONAL SPA
054744	CEREAL DOCKS SPA
057462	CEREAL DORICA S.R.L.
057273	CFI COMPAGNIA FERROVIARIA ITALIANA S.P.A
057352	CFL CARGO SA
056048	CFL MULTIMODAL SA
048997	CHEMOIL LOGISTIC AG
057096	CHEMOIL LOGISTICS AG - FILIALE ITALIANA
056974	CIMA RIPARAZIONI FERROVIARIE S.R.L. CON UNICO SOCIO
003430	CIMOLAI SPA
057297	CIOS CARGO D.O.O.
057102	CIRCENSIS SAS DI TOGNI DARIO AND C.
030530	CIRCO NEL MONDO DI PILLERI ENRICO & C. S.A.S.
042041	CIRCOSCRIZIONE DOGANALE TARVISIO
005600	CISAF SRL
052479	CISCATO E COMPANY SRL
050675	CKTZ ZAGREB
057147	CLAY LINE SRL
017305	CNH ITALIA SPA
003986	CO.FER.M. S.P.A.
048388	CO.ME.TA.V. S.C.A.R.L.
005801	CO.MET.FER. SPA
055326	COECO SPEDIZIONI SRL
057086	COFCO INTERNATIONAL ITALY SRL
012016	COGNE SPA
057215	COLAS RAIL
056947	COMELLI S.R.L.
039939	COMET SRL
054551	COMMERCIALE EUROPEA SRL
015645	COMMERCIALE FERROTUBI SPA
004409	COMMERCIALE SIDERURGICA BRESCIANA
057379	COMMIT SIDERURGICA S.P.A.
006163	COMPAGNIA MERIDIONALE CAFFE SPA
055675	COMPAGNIA PORTUALE S.R.L.
045948	COMPO GMBH
040590	CON.S.ECO SCRL
008505	CONCORDIA SRL
052527	CONEX F.C.M.
005033	CONSORZIO AGRARIO PROVINCIALE
005739	CONSULSPED SRL
057514	CONTINENTAL DYNAMICS D.O.O.
052554	CORN VALLEY S.R.L.
025973	CORTE S.P.A.
010128	COSMEF S.R.L. - COSTRUZIONI MECCANICHE E FERROVIARIE
006022	COSMEF S.R.L. - COSTRUZIONI MECCANICHE E FERROVIARIE
056826	COSMEF S.R.L. - COSTRUZIONI MECCANICHE E FERROVIARIE
057446	COSMO AMBIENTE SRL
057259	COSSI COSTRUZIONI SPA
030889	COSTFER SRL
044377	COSTIERO GAS LIVORNO SPA
011748	COSTRUZIONI LINEE FERROVIARIE SPA
048302	CRONIMET ALFA FERROLEGIERUNGEN HANDELS GMBH
057310	CZ LOGISTICS S.R.O.
056141	D.N. LOGISTICA SRL
052654	D.W.A SRL TRASPORTI
043289	D`ABBONDANZA FABIO
010822	DALMINE SPA
053048	DANU TRANSPORT
049832	DB CARGO AG
055840	DB CARGO AG
057206	DB CARGO AG
056552	DB CARGO FRANCE
054338	DB CARGO ITALIA SRL
056937	DB CARGO LOGISTICS GMBH
054557	DB SCHENKER NIETEN GMBH
048411	DE CESARINA
054678	DE GEORGIO TRASPORTI SRL
017221	DE VITIS SRL
012169	DELNA SPA
057106	DEMONT SLOVAKIA S.R.O.
050635	DEPOSITI COSTIERI TRIESTE S.P.A.
055572	DHL EXPRESS GMBH
056318	DHL FREIGHT -FRANCE- S.A.S.
017731	DHL GLOBAL FORWARDING - ITALY SPA
056998	DHL GLOBAL FORWARDING - ITALY SPA
057289	DIANO SIDERURGICA S.R.L.
028601	DIETIKER AG
038581	DILLINGER HUTTENWERKE
025391	DIMAGOMM DI DIMATERA LORENZO
053149	DINAZZANO PO SPA
039192	DINOS
039193	DINOS D.D.
047447	DISTRIBUZIONE ACCIAI S.R.L.
013637	DITTA LA PORTA TRASPORTI SRL
016230	DOCKS CEREALI SPA
050686	DOCKS CEREALI SPA
014145	DOLCEVITA SRL
040230	DOW DEUTSCHLAND INC
056348	DOW EUROPE GMBH
051434	DOW POLIURETANI ITALIA SRL
043218	DUFERCO COMMERCIALE SPA
025753	DUFERCO COMMERCIALE SRL
024935	DUFERCO SA
057419	DUFERCO SA
041795	DUFERCO TRAVI E PROFILATI S.P.A.
040962	DUFERCO TRAVI E PROFILATI S.P.A.
057198	ECO TRANSIDER S.R.L.
057178	ECOFACTORY EUROPE S.R.O.
011877	ECOFUEL SPA
057459	ECOIN S.R.L.
042117	ECOMET S.R.L.
057489	ECOSYSTEM S.P.A.
027498	EDILSIDER CASERTA SRL
020558	ELECTROLUX LOGISTICS ITALY SPA
012156	ELETT. PARIZZI SPA
025485	EMILIANA ROTTAMI S.P.A.
057139	EMMEBI SRL SISTEMI PER LÆAMBIENTE
052719	ENEL PRODUZIONE S.P.A.
050456	ENEL PRODUZIONE S.P.A.
044273	ENERGAS S.P.A.
056290	ENI S.P.A. - DIVISIONE REFINING & MARKET
009995	ENI S.P.A. - DIVISIONE REFINING & MARKET
003638	ENI S.P.A. - DIVISIONE REFINING & MARKET
005852	ENI S.P.A. - DIVISIONE REFINING & MARKET
052995	ENI S.P.A. - DIVISIONE REFINING & MARKET
057515	ENI SUSTAINABLE MOBILITY S.P.A.
057281	ENKI S.R.L.
057208	ENTE AUTONOMO DEL VOLTURNO SRL
057275	E-P RAIL S.R.L.
057117	EREDI TAMAGNONE S.n.C. di Tamagnone L.ico e Tamagnone G.PPE
055287	ERIDANIA ITALIA S.P.A.
053127	ERMECHEM SA
005565	ERMEWA ITALIA S.R.L.
049569	ERMEWA SA
055200	ESPERIA SRL UNIPERSONALE
010572	ESSO ITALIANA SPA
057321	ETEA GRAIN ITALIA SRL
054376	EURO FERROVIARIA SRL
057507	EUROAMBIENTE SRL
057124	EUROCHEM AGRO GMBH
028821	EUROCOMET SIDERURGICA SRL
054881	EUROCOMET SIDERURGICA SRL
050349	EUROFLEX S.P.A.
044508	EUROGATEWAY SRL
057004	EUROLOGISTIC S.R.L.
056959	EUROLOGSYSTEM D.O.O. BEOGRAD
027872	EURORAIL SA
053546	EUROVIE SCARL
046560	EUSIDER SIDERURGICA SPA
057444	EVM RAIL S.R.L.
056988	EWALS INTERMODAL SRL
054859	EXPRESS INTERFRACHT INTERNATIONAL SPEDITION GMBH
047574	EXPRESS INTERFRACHT INTERNATIONALE SPEDITION GMBH
057252	F.D. COSTRUZIONI S.R.L.
035711	F.LLI  CODOGNOTTO S.P.A.
045460	F.LLI BEATO S.N.C.
041980	F.LLI DI MARTINO SPA
038397	F.LLI FANINI SRL
051286	F.M.G. SRL
057118	F2I HOLDING PORTUALE S.P.A.
013489	FAGIOLI SPA
042382	FAITA EZIO
010887	FANTASIA MARIO
010761	FANTONI S.P.A.
025627	FASTLOG SPA
001570	FCA ITALY S.P.A.
019637	FCA ITALY S.P.A.
026989	FCA ITALY S.P.A.
042706	FCA POLAND S.A.
057474	FCA SPA C/O HODLMAYR HUNGARIA LOGISTICS KFT
056858	FEDRIGONI S.P.A.
056933	FER.NET SRL
019585	FERALPI SIDERURGICA SPA
057369	FEREST LOGISTICS S.r.l.
057388	FEREST RAIL S.R.L.
012044	FERINOX S.A
052740	FERIT S.R.L.
012198	FERRAIOLI & C. S.R.L.
056591	FERRAMENTA PUGLIESE S.N.C.
026874	FERRAMENTA VILLAFRANCA SIDERURGICA SPA
012165	FERRIERE NORD S.P.A.
012589	FERROSIDER S.P.A.
053805	FERROSUD S.P.A
027902	FERROVIE DEL GARGANO S.R.L.
044668	FERROVIE DEL SUD-ESTServizi Automobilistici S.r.l.
051062	FERROVIE EMILIA ROMAGNA SRL
056721	FERROVIE NORD S.P.A.
019824	FERSALENTO S.R.L.
022437	FERSPED D.D.
048748	FERTRANS AG
057223	FIAT CHRYSLER AUTOMOBILES SPA C/O F.T.UE.
057447	FIAT CHRYSLER AUTOMOBILES SPA C/O TEA
057222	FIAT CHRYSLER AUTOMOBILES SPA C/O TEA CORBAS
016165	FIORIO COLORI SPA
020261	FIREMA TRASPORTI SPA
019125	FLLI VALLETTI SRL
057466	FONDAZIONE FS ITALIANE
057170	FONTI ALTA VALLE PO S.P.A.
057005	FORELLI PIETRO SRL
057424	FORWARDIS GMBH
057290	FORWARDIS S.A.
041111	FRANCESCHINO ONELIO
005026	FRANCHINI LAMIERE S.P.A.
017871	FRATELLI MASTROTOTARO & C. SRL
011833	FRATELLI MONDOLA SRL
057422	FRET SNCF
003361	FRIULANA GAS S.P.A.
012464	FRIULTRANS SPA
056856	G. TRANSPORT 96 KFT
057485	G.T. GENERATION TRANSPORT SRL
021221	GAB SPEDIZIONI INTERNAZIONALI SRL
010716	GABRIELLI S.P.A.
013450	GALBIATI SRL
030468	GEBRUDER WEISS RAIL CARGO G.M.B.H.
057358	GEFCO CESKA REPUBLIKA S.R.O.
057329	GEFCO D.O.O.
057214	GEFCO FRANCE SAS
057495	GEFCO ITALIA S.P.A.
018391	GEFCO ITALIA S.P.A.
057328	GEFCO POLSKA
025642	GEFCO SA
005493	GEFER SPA
052991	GENERALE COSTRUZIONI FERROVIARIE SPA
014152	GENERALTUBI SPA
048017	GERI MASSIMO SPA
052209	GESFA SRL
028103	GEST. COMM.LE GOVERNATIVA PER LE FERROVIE DEL SUD-EST
054523	GESTIONE SERVIZI INTERPORTO SRL
056891	GETOIL SRL
052867	GETOIL SRL
039583	GHIRARDI GIORDANO SRL
017046	GIORDO SRL
053459	GIUGLIANO COSTRUZIONI METALLICHE SRL
056447	GL&T CARGO S.R.L.
054246	GLEISFREI S.R.L.
057428	GLENCORE AGRICULTURE BV
055797	GLOBAL PROJECTS SRL
054942	GLOBALFER S.P.A.
057279	GLOBE INTERNATIONAL LTD
057417	GORTANI SRL
012635	GOVERNATORATO CITTA DEL VATICANO
056915	GOZD LJUBLJANA D.D.
056916	GOZDNO GOSPODARSTVO BREZICE D.O.O.
056917	GOZDNO GOSPODARSTVO CELJE D.O.O.
056918	GOZDNO GOSPODARSTVO NOVO MESTO D.D.
007584	GRANDI MOLINI ITALIANI SPA - MARGHERA
022682	GRANDI MOLINI ITALIANI SPA - MARGHERA
057377	GRIGLIATI BALDASSAR S.R.L.
054477	GRIMALDI COMPAGNIA DI NAVIGAZIONE SPA
057220	GRIMALDI EUROMED SPA
057494	GRUPPO CORDENONS SPA
012167	GRUPPO MERCURIO SPA
054993	GRUPPO MINERALI SPA
042540	GRUPPO VALSECCHI ARMAMENTO FERROVIARIO
054487	GTS SPA
053575	GUY DAUPHIN ENVIRONNEMENT - GDE
054272	HANGARTNER TERMINAL S.R.L.
053796	HANNIBAL SPA
057437	HARGREAVES RAW MATERIAL SERVICES GMBH
057138	HEPTA ITALIA S.R.L.
057247	HERAMBIENTE S.P.A.
057268	HITACHI RAIL ITALY S.P.A.
056580	HITACHI RAIL STS S.P.A.
057327	HITZINGER TRANSPORTE
057332	HOEDLMAYR HUNGARIA LOG.
057361	HOEDLMAYR LOGISTIKA D.O.O.
057031	HOLZHOF BREITENBACH GMBH & CO KG
057228	HUPAC INTERMODAL N.V.
030248	HUPAC INTERMODAL S.A.
057137	HUPAC INTERMODAL SA
001695	HUPAC SPA
057353	HZ CARGO D.O.O.
056687	I - FAST AUTOMOTIVE LOGISTICS S.R.L.
049497	I.E.S.
057441	I.ME.VA. S.P.A.
004023	I.METALS S.R.L. -CONSULENZE COMMERCIALI-
049743	I.RO.P. S.P.A.
046757	I.T.S. - INTERMODAL TRAILER SERVICE SRL
057294	IBP ITALIAN BIO PRODUCTS SRL CON SOCIO UNICO
057298	IDEALSERVICE SOC. COOP.
024479	IES ITALIANA ENERGIA E SERVIZI SPA -MN-
056095	IFA SRL
057068	IGNAZIO MESSINA & C. SPA
048691	IL MERCATINO DELLANTICO DI COEN ALEXANDER
001585	ILVA SPA
029723	ILVA SPA IN AMMINISTRAZIONE STRAORDINARIA
029741	ILVA SPA IN AMMINISTRAZIONE STRAORDINARIA
057488	IMATEQ ITALIA SRL CON SOCIO UNICO
007941	IMOLA LEGNO S.P.A.
053581	IMPA SRL
013809	IMPRESA FRANCESCO VENTURA COSTRUZIONI FERROVIARIE S.R.L.
056262	IMPRIMET S.R.L.
057248	IMR INNOVATIVE METAL RECYCLING GMBH
057938	INA - INDUSTRJIA NAFTE D.D.
057425	INAGRA SRL
057427	INDUSTRIA MOLITORIA DENTI S.R.L.
030277	INDUSTRIALFERRO SRL
025103	INDUSTRIE CHIMICHE DI BUCCINASCO
054100	INEOS MANUFACTORING ITALIA S.P.A.
057469	INFRARAIL FIRENZE S.R.L.
044657	ING. DE ALOE COSTRUZIONI SRL
010559	INGRA BROZZI SPA
040678	INNOCENTI DEPOSITI SPA
056913	INOVYN FRANCE SAS
057199	INOVYN ITALIA PRODUZIONE ITALIA SPA
056466	INRAIL S.P.A.
052104	INTERBRENNERO S.P.A.
009961	INTERCONTAINER-INTERFRIGO -ICF- SA
022436	INTERFRACHT S.R.O.
057187	INTERMODECO
057260	INTERPORTO BOLOGNA S.P.A.
057013	INTERPORTO CERVIGNANO DEL FRIULI S.P.A.
056279	INTERPORTO DELLA TOSCANA CENTRALE
056824	INTERPORTO PADOVA SPA
057348	INTERPORTO SERVICES PRATO S.R.L.
057344	INTERPORTO SUD EUROPA SPA
056094	INTER-RAIL SPA
057204	INVESTEX GROUP S.R.O.
011599	IPEM SPA
008458	IRON SPA
051291	ITAL BI OIL SRL
046911	ITALFER CARPENTERIE S.R.L.
024042	ITALFERRO SRL - DIVISIONE ECOFER
025921	ITALIANA COKE SRL
001587	ITALIMPIANTI SPA
009998	ITALMARITTIMA SRL
044643	ITALPRESSE ENGINEERING SPA
056462	ITALPRESSE INDUSTRIE SPA
054518	ITALTRADE SRL
057409	IVICT EUROPE GMBH
011296	JAS JET AIR SERVICE SPA
030579	JERICH ITALIA SRL
057271	JSW ENTERPRISE A SOCIO UNICO
054342	JUCKER HOLZ+N.STEINH.GMBH
038769	KALI UND SALZ GMBH
057173	Karner Speditions- u Transportgesellschaft m.b.H.
053865	KATOEN NATIE ITALIA SRL
044847	KIMBERLY CLARK EUROPE LTD.-KC SRL VIA DELLA ROCCA 49 TO-
057518	KOMBI TERMINAL MORTARA SRL
030252	KOMBIVERKEHR DEUTSCHE G.M.B.H. AND CO. KG
057458	KOVOSROT GROUP CZ A.S.
057487	KRISTAL SUNOKO D.O.O.
056582	KRONOSPAN ITALIA SRL
038387	L.I.S.E.C. SRL
048804	L.M. LOGISTICA MOLISANA SRL
005756	L.T. LAMIERE TAGLIATE SPA
057371	L`AUTOGAS OROBICA SPA
024928	L`AUTOGAS OROBICA SPA
019858	LA BRUZIA DISTRIBUZIONE SOC. COOP. A R.L.
055876	LA PETROLIFERA ITALO RUMENA SPA
057098	LA PETROLIFERA ITALO RUMENA SPA
052486	LAGERMAX AUTOTRANSPORT GMBH
057438	LAGERMAX AUTOTRANSPORT GMBH
012804	LAMERI SPA
011040	LAMPOGAS SPA
057372	LAMPOGAS SRL
052721	LANZA INTERNATIONAL SRL
052221	LANZI TRASPORTI SRL
057225	LEALI STEEL SPA
057394	LIBERTY MAGONA S.R.L.
057430	LIBERTY TILLET SAS
057401	LINEAS NV
057373	LIQUIGAS SPA - BRESCIA
011744	LIQUIGAS SPA - BRESCIA
045885	LO.TRA.FER SRL
049422	LOBE & CO.
048991	LOCAPAL
042369	LOESCH HELMUTH - HOLZHANDEL
054468	LOGESTA ITALIA S.R.L.
052190	LOGI. FER. SRL
057325	LOGISTICA MERIDIONALE SRL
048961	LOGISTICA UNO EUROPE S.R.L.
042389	LOGTAINER SRL
057217	LOKOMOTION GMBH
011653	LONATO SPA
057384	LOTOS KOLEJ SP. Z O.O.
047418	LOTRAS SRL
025593	LOUIS DREYFUS COMPANY ITALIA SRL
057323	LTE AUSTRIA GMBH
057393	LTE HUNGARIA VASUTI ARUFUVAROZO ES LOGISZTIKAI KFT
057320	LTE LOGISTIK UND TRANSPORT GMBH
012855	LU.CA.M. SPA
005900	LUCA TRASPORTI SAS
053791	LUCCHINI PIOMBINO SPA
003601	LUCCHINI SPA IN AMMINISTRAZIONE STRAORDINARIA
029787	LUCCHINI SPA IN AMMINISTRAZIONE STRAORDINARIA
051741	LUGO TERMINAL SPA
015245	LUIGI LAVAZZA S.P.A.
056711	M W R S.R.L.
005252	M.D.B. SPA - MAGAZZINI DESIO BRIANZA
053405	M.V.O. SRL MAGAZZINI DEL VENETO ORIENTALE
045526	MA. RA. S.R.L.
004233	MAGAZZINI GENERALI DOGANALI VERCELLI SRL
055882	MANCINI IMBALLAGGI SNC
002208	MANNISIPRE SPA
050026	MANTINI SRL
051908	MANTOVANI SPA
047722	MAPEI SPA
029702	MAR.GI. SRL
057264	MARCEGAGLIA CARBON STEEL S.P.A.
057503	MARCEGAGLIA PLATES SPA
011823	MARCEGAGLIA SPA
018533	MARCEGAGLIA SPA
057265	MARCEGAGLIA SPECIALTIES S.P.A.
057516	MARCEGAGLIA SPECIALTIES S.P.A.
050249	MARGARITELLI FERROVIARIA S.p.A.
029904	MARGARITELLI SPA
044551	MARLINES SRL SHIPPING AGENCY
044553	MARLINES SRL SHIPPING AGENCY
056832	MARTERNERI S.P.A.
022855	MARTINELLI GIORGIO
046336	MARTINICO ORNAMENTAL PLANTS S. S.
012164	MASIERO SECONDO
057343	MATISA MATERIEL INDUSTRIEL S.A.
009903	MATISA SPA
057009	MAXI SRL
057463	MEDWAY ITALIA S.R.L.
011782	MER MEC SPA
014156	MERCITALIA INTERMODAL SPA
015462	MERCITALIA INTERMODAL SPA
050698	MERCITALIA LOGISTICS S.P.A.
052121	MERCITALIA LOGISTICS S.P.A.
009792	MERCITALIA LOGISTICS S.P.A.
057302	MERCITALIA RAIL S.R.L.
048478	MERCITALIA SHUNTING & TERMINALS.R.L.
044342	MESSIDER SRL
057113	MET. EXTRA S.P.A.
050937	METAL SERVICE SRL
025190	METALLURGICA ABRUZZESE
003900	METALLURGICA PIEMONTESE
005688	METALSERVICE S.P.A.
048841	METALSIDER SPA
028932	METALSIDER SPA
057079	METCOSPED
057227	MEVO-METZLER GMBH
057255	MFT ITALIA S.R.L.
012912	MICHELETTI PIETRO SRL
057305	MICOS SPA û IMPRESA DI COSTRUZIONI
057085	MIDA SRL
057391	MILOTTA RICAMBI E METALLI S.R.L.
048204	MIN.TRASP.GEST.COMM.GOV.FS SPA FERROVIA CIRCUMETNEA
057504	MINERARIA DI BOCA SPA
056804	MINISTERO DIFESA-DIR. GEN. DI COMM.TO E SERVIZI GENERALI
057070	MINISTERO DIFESA-DIR. GEN. DI COMM.TO E SERVIZI GENERALI
057071	MINISTERO DIFESA-DIR. GEN. DI COMM.TO E SERVIZI GENERALI
057072	MINISTERO DIFESA-DIR. GEN. DI COMM.TO E SERVIZI GENERALI
057119	MINISTERO DIFESA-DIR. GEN. DI COMM.TO E SERVIZI GENERALI
057077	MINISTERO DIFESA-DIR. GEN. DI COMM.TO E SERVIZI GENERALI
056812	MIT NUCLEARE S.R.L.
010796	MOLINI INDUSTRIALI SPA
055792	MOLINO BONGIOVANNI SRL
056819	MOLINO CASILLO S.P.A.
024055	MOLINO COSMA SNC
043362	MOLINO DI SAN GIOVANNI SPA
007696	MOLINO F.LLI CHIAVAZZA
057015	MONCADA SOLAR EQUIPMENT SRL
057057	MONFER CEREALI SRL
010395	MONFER SPA
039216	MONFERR SRL
056106	MONSUD S.P.A.
004519	MONTALBETTI S.P.A.
057472	MOSCA S.R.L.
054605	MOSER BAUFACH & AGROZENTRUM
057330	MOSOLF Logistics & Services GmbH Niederlassung Kippenheim
057333	MOSOLF SE & CO. KG
057236	MOVE INTERMODAL NV
042527	MOVI.SID SRL
055658	MOVINTER SRL
057374	MP MARKETING PROJECTS HANDELSGES GMBH
001735	MSA ITALIANA S.P.A.
057386	MT LEGNAMI S.R.L.
057500	MULLER GLEISBAU AG
053654	MULTI SERVICE SRL
057448	MULTILOGISTICS TRANSPORT SRL
054594	MULTISERVICE SRL
004711	NASTROFER S.P.A.
004370	NAVALIA S.R.L.
057287	NAVICELLI DI PISA SPA
004442	NEGRI S.R.L.
057335	NERI DEPOSITI COSTIERI SPA
023418	NERI SPA
056296	NESKA SCHIFFAHRTS- UND SPEDITIONSKONTOR GMBH
057322	NESTLE WATERS MARKETING& DISTRIBUTION SAS
003186	NESTLE` ITALIANA S.P.A.DIVISIONE PRODOTTI DOLCIARI
003376	NESTLE` ITALIANA S.P.A.DIVISIONE PRODOTTI DOLCIARI
057492	NESTRADE SA
004703	NICHEL LEGHE S.P.A.
056980	NICOLOSI TRASPORTI S.R.L.
056207	NICROSTEEL SRL
055063	NORDA SPA
018628	NORDISK TRANSPORT RAIL ABATT.NE SIG.SIRPA PERSSON
050990	NOVA S.P.A. CON SOCIO UNICO
045888	NOVA SPA
030253	NOVATRANS
005477	NOVATRANS ITALIA S.R.L.
010175	NOVATRANS ITALIA S.R.L.
038911	O.D.P.A.D. PIVKA
054883	O.PRE.MECCANICA SRL
057112	OCEANOGATE ITALIA S.P.A.
056811	OLEIFICIO SAN GIORGIO SPA
025276	OLEIFICIO ZUCCHI SPA
048994	OLIVINI GIUSEPPE SRL
057179	OMV REFINING&MARKETING GMBH
057493	OPEL AUTOMOBILE GMBH
004431	ORI MARTIN ACCIAIERIA FERRIERA DI BRESCIA SPA-STAB. CEPRANO
057443	ORR OFFICINA RIPARAZIONE ROTABILI S.R.L.
025573	OTS-OMNIA TRASPORTI SPECIALI SRL
001602	OTS-OMNIA TRASPORTI SPECIALI SRL
057486	PA SERVICE SRL
013278	PADANA ROTTAMI SRL
015286	PADANA TUBI E PROFILATI ACCIAIO SPA
054450	PALOMA D.D.
045167	PANFERTIL SRL
042580	PANLOG VON MOOS AG
057056	PAOLETTI ECOLOGIA SRL
057433	PARATORI SRL
057044	PASQUINELLI ENNIO SPA
014959	PASQUINELLI ENNIO SPA
018585	PASTIFICIO F.LLI MAIONE SPA
026406	PAVIND SRL
056962	PECOVASA RENFE MERCANCIAS S.A.
038564	PGN LOGISTICS ITALIA SRL
027006	PIACENTINI COSTRUZIONI
055066	PINTO MASSIMO
057191	PKP CARGO CONNECT SP. Z O.O.
057498	PKP CARGO INTERNATIONAL A.S.
046635	PLANETA SS
030071	POL RAIL SRL
002104	POLATO LEONE INGROSS. FERRAMENTA
023425	POLETTI & C. SRL
024485	POLYNT S.P.A.
024623	POLYNT S.P.A.
024708	POLYNT S.P.A.
028451	PORTO DI CARRARA SPA
008413	PORTO INTERMODALE RAVENNA SPA SAPIR PORTO INTERMODALE RAVENN
056288	PRESIDENZA DEL CONSIGLIO DEI MINISTRI - SOTTOSEGRETARIO/MITO
024855	PRESIDENZA DEL CONSIGLIO-DIPARTIMENTO PROTEZIONE CIVILE
005049	PRO.RE.NA. S.P.A.
056375	PRODUCTION GROUP
056070	PROFESSIONAL LEGNAMI SRL
015464	PROFILTUBI S.P.A.
011294	PROGRESSO E LAVORO S.C.R.L.
057061	PRVA SLOVENSKA ZELEZNICNA AKCIOVA SPOLOCNOST
057497	PSA AUTOMOBILES SA
049961	PUNTO CASA
053129	PUNTO SYSTEM SPA
038857	PURFER SA
057253	PVS SERVICES ITALIA SRL
056327	QUADRANTE EUROPA TERMINAL GATE SPA
052580	QUADRANTE SERVIZI SRL
030502	R.A. SPEDIZIONI DI G. RAGONESI
056111	R.D.3. DI PAOLO MASSANO
014615	R.F.I. - RETE FERROVIARIA ITALIANA
056976	R.F.I. - RETE FERROVIARIA ITALIANA
014620	R.F.I. - RETE FERROVIARIA ITALIANA
014665	R.F.I. - RETE FERROVIARIA ITALIANA
014682	R.F.I. - RETE FERROVIARIA ITALIANA
014729	R.F.I. - RETE FERROVIARIA ITALIANA
014744	R.F.I. - RETE FERROVIARIA ITALIANA
014773	R.F.I. - RETE FERROVIARIA ITALIANA
014814	R.F.I. - RETE FERROVIARIA ITALIANA
039881	R.F.I. - RETE FERROVIARIA ITALIANA
039887	R.F.I. - RETE FERROVIARIA ITALIANA
039927	R.F.I. - RETE FERROVIARIA ITALIANA
039930	R.F.I. - RETE FERROVIARIA ITALIANA
039957	R.F.I. - RETE FERROVIARIA ITALIANA
039977	R.F.I. - RETE FERROVIARIA ITALIANA
039986	R.F.I. - RETE FERROVIARIA ITALIANA
040026	R.F.I. - RETE FERROVIARIA ITALIANA
040036	R.F.I. - RETE FERROVIARIA ITALIANA
056119	R.F.I. - RETE FERROVIARIA ITALIANA
056575	R.F.I. - RETE FERROVIARIA ITALIANA
057091	R.F.I. - RETE FERROVIARIA ITALIANA
057363	R.F.I. - RETE FERROVIARIA ITALIANA
057382	R.F.I. - RETE FERROVIARIA ITALIANA
057475	R.F.I. - RETE FERROVIARIA ITALIANA
056860	R.F.I. - RETE FERROVIARIA ITALIANA
056862	R.F.I. - RETE FERROVIARIA ITALIANA
056863	R.F.I. - RETE FERROVIARIA ITALIANA
056866	R.F.I. - RETE FERROVIARIA ITALIANA
056867	R.F.I. - RETE FERROVIARIA ITALIANA
056869	R.F.I. - RETE FERROVIARIA ITALIANA
056871	R.F.I. - RETE FERROVIARIA ITALIANA
056889	RADICI CHIMICA ITALIA SPA
010885	RAFFINERIA SARPOM
011100	RAFFINERIA SARPOM
055748	RAIL CARGO AUSTRIA AG
056077	RAIL CARGO CARRIER ITALY SRL
057304	RAIL CARGO HUNGARIA
038268	RAIL CARGO LOGISTICS - AUSTRIA GMBH
057163	RAIL CARGO LOGISTICS - AUSTRIA GMBH
050077	RAIL CARGO LOGISTICS - ITALY SRL
057376	RAIL CARGO LOGISTICS D.O.O.
051871	RAIL CARGO LOGISTICS GMBH
057431	RAIL CARGO LOGISTICS û HUNGARIA KFT
039604	RAIL CARGO LOGISTISCS D.O.O.
057256	RAIL CARGO OPERATOR - AUSTRIA GMBH
052616	RAIL CONSULT SRL
027093	RAIL SERVICE
056984	RAIL SERVICE SRL
057027	RAIL SERVICES SRL
057315	RAIL&SEA LOGISTICS GMBH
057471	RAVAGRICOLA SRL
005476	RAVAGRICOLA SRL
057442	REGIORAIL FRANCE
057349	REMIND LOGISTICS S.R.L.
023501	RHENUS LOGISTICS S.P.A.
054656	RHENUS PORT LOGISTICS
056341	RHENUS PORT LOGISTICS AG
001699	RIVA ACCIAIO SPA
047548	RIVA ACCIAIO SPA
056099	RIVALTA TERMINAL EUROPA S.P.A.
056505	RO. GALEGNO S.R.L
011174	ROBERTO BUCCI SPA
003040	RODANTE BRICOLEGNO DI RODANTE G.E.G.%C.S.N.C.
013667	ROLLA TRAVERSO & STORACE SPA
056908	ROM RAIL TRANSPORT SRL
054846	ROMA TERMINAL S.R.L.
053078	ROSSI RENZO COSTRUZIONI SRL
055683	S.A.GE.M KOPER D.O.O.
057088	S.A.P.NA. Sistema Ambiente Provincia di Napoli SpA
056978	S.C. TRANSFEROVIAR GROUP S.A.
020080	S.I.A.T. S.P.A. - SOCIETA` ITALIANA ACCIAI TUBI
057043	S.I.M. SISTEMI D INGEGNERIA MANUTENTIVA S.R.L.
012457	S.I.T.F.A. S.P.A.
055845	S.I.T.F.A. S.P.A.
057481	S.I.T.F.A. S.P.A.
057508	S.I.T.F.A. SPA C/O GEFCO AUTOMOTIVE SERVICES
001841	S.N.A.C.I. SPA
050280	S.T.I. INTERNAZIONALE SPA
028173	SAAR SPA
057237	SABEL LOG. SRL
050148	SACCHETTI VINCENZO
054741	SAFER COSTRUZIONI SRL
056500	SAFOND - MARTINI SRL
023934	SAIMA AVANDERO SPA
028837	SALCEF SPA
057168	SALCEF SPA A SOCIO UNICO
045813	SALONIT ANHOVO, GRADBENI MATERIALI, D.D.
046823	SALZGITTER AG STAHL UND TECHNOLOGIE
057506	SAMER & CO. SHIPPING D.O.O.
015371	SAMER & CO. SHIPPING SPA
018846	SAMPAOLO FLAVIO
053056	SAN MARCO GAS LOGISTICA E SERVIZI SRL
046622	SAN MARCO PETROLI S.P.A.
020089	SAN POLO LAMIERE SPA
053531	SAN ZENO ACCIAI - DUFERCO S.R.L.
030144	SANGOI SPA
056131	SANPELLEGRINO S.P.A.
047389	SANTARELLA SRL
057502	SAPPI ITALY OPERATIONS SPA
057276	SARMI SRL
056796	SATIS ITALSEMPIONE SA
057238	SBB CARGO AG KREDITOREN CARGO 3100
056956	SBB CARGO INTERNATIONAL AG
054758	SBB CARGO ITALIA SRL
057375	SC MANAGE LOG SRL
042949	SCALA VIRGILIO E FIGLI S.R.L.
050997	SCALICI IGNAZIA
054446	SCAM S.N.C.
038783	SCHENKER & CO AG -35204
001664	SCHENKER ITALIANA S.P.A.
024921	SCHENKER ITALIANA S.P.A.
057051	SCHENKER KFT
049958	SCHWEITZER LOGISTIK
055441	SDAG SPA A SOCIO UNICO
057405	SE.GE.CO SRL
042385	SEAS SOCIETA` EDILE ACQUEDOTTI STRADE SPA
057460	SEASTOCK S.R.L.
050166	SEAWAY SRL
055699	SEGECO SRL
057089	SERAPIDE TRANS S.A.S.
057130	SERV.ISE SRL
007955	SETRAMAR S.P.A.
049284	SETRANS
012701	SETRASPED SPA
001611	SEVEL SPA
057395	SHIP SERVICE VENEZIA SRL
044030	SIAT SPA SOCIETA ITALIANA ACCIAI TRAFILATI
057000	SICILIA ROTTAMI S.R.L.
057436	SICIM SRL
011588	SICOM S.p.A.
054555	SIDERALBA SPA
054757	SIDEREDIL SAS
041809	SIDERGAS SPA
046734	SIDERMEC SRL
051816	SIDERMETAL S.R.L.
057411	SIDERPOTENZA S.P.A.
044437	SIDERPOTENZA SPA - POTENZA
039834	SIDERURGICA FIORENTINA S.P.A.
047903	SIDERVAL SPA
031075	SIDERVER SRL
057140	SILOMAR SPA
029911	SIPEM SPA
038629	SIPRO SIDERPRODUKTE AG
038687	SIREC THEVENAZ-LEDUC SA 24882-3
057306	SISAM AGENTI SRL
057115	SIT LOGISTICS S.P.A.
057060	SITAV S.P.A.
057295	SLADORANA D.O.O.
054839	SLASKIE CENTRUM LOGISTYKI S.A.
047565	SLOVENSKE ZELEZNICE
057149	SNCB LOGISTICS SA
047846	SNCF-DIRECTION FRET COMBI EXPRESS
055744	SNCF-DIRECTION FRET COMBI EXPRESS
054745	SOC.D`ALTERIO LOGISTICA SRL
027396	SOCFEDER SPA
057218	SOCIETA COOPERATIVA C.A.R.S.
057274	SOCIETA UNICA ABRUZZESE DI TRASPORTO (TUA) S.P.A. UNIPERS
055204	SOCIETA` FERROVIARIA APUO VENETA SRL
057263	SOCIETA` GENERALE SRL
057370	SOCOGAS S.p.A.
015773	SOCOGAS S.p.A.
053551	SODECA SRL
017716	SOFIS INTERNATIONAL SRL
056890	SOLVAY CHIMICA ITALIA SPA
048026	SOLVAY CHIMICA ITALIA SPA
056912	SOLVAY FLUOR ITALIA S.P.A.
045185	SOLVAY SPECIALTY POLYMERS FRANCE
056999	SOLVAY SPECIALTY POLYMERS ITALY SPA
057081	SOLVAY SPECIALTY POLYMERS ITALY SPA
056771	SOVEGAS PRODOTTI SPECIALI SRL
011948	SOVEGAS SPA
004361	SOVEGAS SPA
053025	SOVTRANSAVTO ITALIA SRL
008516	SPAZZONI GIUSEPPE SPA
056707	SPED TRANS HUNGARIA KFT
056955	SPEDICA AGRO S.R.O.
014077	SPENO INTERNATIONAL S.A.
046636	SPINELLI SRL
057423	SRS TRINACRIA LOGISTICA S.R.L.S.
057383	SRT SRL
054541	STAHL GERLAFINGEN AG
030650	STAHLWERKE THURINGEN GMBH (2533842)
057366	STANDARD LOGISTIC D.O.O.
057090	STANDARD LOGISTIK D.O.O. DOBOJ
039021	STORA ENSO KABEL GMBH (511386)
024459	STRADA ING. ACHILLE SPA
020298	STRAMMIELLO TRASPORTI
045938	STVA
056895	STYRON EUROPE GMBH
056778	STYRON ITALIA S.R.L.
039168	SUROVINA MARIBOR
056852	T&T METALLI E COMPOSITI SPA
004815	T.C.F. DI ANTONIO ROSIGNOLI & C. S.A.S.
025543	T.C.F.S. TRASPORTI CELERI FS
035036	T.C.F.S. TRASPORTI CELERI FS
057100	T.I.M.O. SRL - TERMINAL INTERMODALE DI MORTARA
025605	T.O. DELTA SPA - LIVORNO
051890	T.R.C. SRL
050419	T.S.M. TECNO SERVIZI MOLISANI SAS
049374	T.T. CARGO AG
055780	T.T. CARGO MEDNARODNI PREVOZI D.O.O
057169	TAMAGNONE S.R.L.
056415	TAMOIL RAFFINAZIONE SPA
016487	TARDIOLI ALFREDO SRL
015270	TARROS S.P.A.
053412	TATA STEEL BV
023114	TECNOFER SRL
057496	TECNOFONDI SPA
054143	TECNOSERVICE SRL
011919	TECNOTUBI S.P.A.
036201	TECNOTUBI S.P.A.
057240	TERMINAL ALTI FONDALI S.R.L.
055673	TERMINAL PIACENZA INTERMODALE SRL
057340	TERMINAL RINFUSE GENOVA S.R.L.
057231	TERMINAL SINGEN TSG GMBH
011587	TERMINALE FERROVIARIO VALPOLICELLA SPA
056660	TERMINALI ITALIA SRL
057288	TERMINI SCARL
057435	TERNA RETE ITALIA S.P.A.
057439	TERRANOVA S.R.L.
057396	TESMEC RAIL SRL
057362	TESMEC SERVICE S.R.L.
054847	TESSIVAL SUD SRL
049587	TETRA PAK PET ITALIA SRL
045238	THOMMEN AG
038196	THYSSEN VERKEHRS GMBH
052491	THYSSENKRUPP ELECTRICAL STEEL AST SPA
041024	TICINO LAMIERE SRL
057257	TITAGARH FIREMA ADLER S.P.A.
056000	TN INTERNATIONAL
005973	TOMASO PRIOGLIO SPA - FORTEZZA
057036	TOP RAIL SRL
057397	TOUAX RAIL LIMITED
026163	TRA.DE. SRL
011096	TRAIANA SRL
047292	TRAILER S.P.A.
056854	TRAIN HUNGARY MAGANVASUT KFT
057350	TRAINOSE TRANSPORTS
054282	TRANS CARGO LOGISTIC D.O.O.
057470	TRANS ISOLE S.R.L.
057270	TRANSAGENT D.O.O.
057167	TRANSAGENT D.O.O.
057413	TRANSEXPRESS EOOD
057183	TRANSFEROVIAR GRUP S.A.
055837	TRANSPED SPA
025686	TRANSWAGGON GMBH - 6247
012885	TRANSWAGGON SPA
020146	TRANSWAGGON SPA
057296	TRANSYSTEM S.P.A.
057230	TRASNOVA SRL
015465	TRASPORTI PESANTI DI STORTI TULLIO E C. SRL
057244	Trasporti Pesanti S.r.l.
016449	TRASPORTO FERROVIARIO TOSCANO S.P.A.
057067	TRASPOSERVIZI SRL
053461	TRAVI E PROFILATI DI PALLANZENO SPA
057084	TRAVI E PROFILATI DI PALLANZENO SPA
045465	TREMOLADA SRL
056030	TRENITALIA LOGISTICS FRANCE S.A.S.
014824	TRENITALIA SPA
014962	TRENITALIA SPA
040178	TRENITALIA SPA
044974	TRENITALIA SPA
048723	TRENITALIA SPA
056497	TRENITALIA SPA
057307	TRENORD SRL
053963	TRENTINO TRASPORTI SPA
029608	TRIESTE TERMINAL CEREALI SRL
057387	TRUCK RAIL CONTAINER S.P.A. UNIPERSONALE
051962	TTS TRANSTERMINAL RAIL AG
043123	TUZI COSTRUZIONI GENERALI SRL
053407	TX LOGISTIK AG
056799	TX LOGISTIK AG
011474	UNICOAL SPA
048500	UNIECO SOC. COOP.
057385	UNIOIL S.R.L
043740	UNIVAR SPA
057416	URSINO SRL
015658	US FORCES EUROPE -US ARMY FIN. & ACCOUNT. CENTER-
056451	V.G.S. VENETA GESTIONE SERVIZI S.R.L.
057116	V.L.S. S.R.L.
050552	VALENZANO SRL
054632	VALTENESI SRL
057185	VARO ENERGY MARKETING AG
053877	VASTOFERRO SRL
013325	VENETA LAVAGGI SRL
031787	VENETA LAVAGGI SRL
057468	VENETA LAVAGGI TURBO SRL
020218	VENETA NASTRI S.P.A.
041615	VERONICA IMPORT-EXPORTB SRL
056932	VERSALIS S.P.A.
026567	VERSALIS S.P.A.
026686	VERSALIS S.P.A.
026718	VERSALIS S.P.A.
049712	VICO SRL
030923	VIDIMAR & FABRIS SNC
057477	VIGER TRASPORTI SRL
011827	VIGLIENZONE ADRIATICA S.R.L.
005031	VIGLIENZONE ADRIATICA SPA
057337	VIIA
057465	VIIA
039330	VINAVIL SPA
057261	VIRO TVORNICA SECERA D.D.
057392	VISA GLOBAL LOGISTICS S.P.A.
038617	VOEST ALPINE ROHSTOFFBESCHAFFUNGS GMBH
044472	VOEST ALPINE SCHIENEN GMBH & COKG
057246	VOGTLANDBAHN GMBH
012168	VOLPONI LEGNAMI SRL
057197	VOSSLOH ESPANA S.A.
046465	VTG
055397	VTG DEUTSCHLAND GMBH
010137	VTG ITALIA SRL
057136	VTG RAIL LOGISTICS AUSTRIA GMBH
057150	VTG RAIL LOGISTICS DEUTSCHLAND GMBH
057245	VTG RAIL LOGISTICS DEUTSCHLAND GMBHSuccursale Italiana
056670	VTG RAIL LOGISTICS FRANCE SAS
056833	WALTER TOSTO S.P.A.
055787	WILSIDER S.R.L.
053052	WOODFIRE - DI BRAIDOTTI MAURO
057055	XELLA ITALIA SRL
040679	YARA ITALIA SPA
057510	YPARCO SRL
053866	ZELLSTOFF POELS
057490	ZINCHITALIA SPA
052959	T.F.T. SRL
053490	NOVAOL SRL
056693	INTERPORTO VAL PESCARA S.P.A.
056909	MAGANETTI SPEDIZIONI SPA
057342	SERVIZI LOGISTICI INTEGRATI SRL
057491	COOPERATIVA FACCHINI PORTABAGAGLI
057509	ELSWAY D.O.O.
057440	CAR S.R.L. SEGNALETICA STRADALE
057449	IKEA DC
057450	AEG ELECTROLUX
057451	MULLER-DIE LILA LOGISTIK OST GMBH
057452	BLG LOGISTIK SOLUTIONS GMBH
057453	ELECTROLUX
057454	ELKJOP GROSSIST
057455	ELECTROLUX DIENSTLEISTUNGS GMBH
057456	ELECTROLUX BV
057457	ELGIGANTEN
057464	BIM SERVICE S.R.L.
057467	STUKWERKERS HAVENBEDRIJF N.V.
057473	ARS SERVICE S.R.L.
057479	HEXA GREEN SRL
057484	SIDERECO S.R.L.
057505	RAILADVENTURE GMBH
057511	I.CO.P. S.P.A. SUCCURSALE EN FRANCE
566588	PITTINI SIDERPRODUKTE AG
057519	SEA TANK TERMINAL ANTWERP

Risposta:
"""
	llm = AzureChatOpenAI(
		azure_endpoint=os.getenv("AZURE_OPENAI_BASE"), 
		api_key=os.getenv("AZURE_OPENAI_KEY"),
		api_version=os.getenv("AZURE_OPENAI_API_VERSION"),
		max_tokens=1000, 
		temperature=0,
		deployment_name=os.getenv("AZURE_OPENAI_MODEL"),
		model_name=os.getenv("AZURE_OPENAI_MODEL_NAME"),
		streaming=True, callbacks=[StreamlitCallbackHandler(container_stream)]
	)

	output_parser = StrOutputParser()

	prompt = ChatPromptTemplate.from_messages([
		("system", "You are an AI assistant."),
		("user", "{input}")
	])
	
	chain = prompt | llm | output_parser
	chain.invoke({"input": input})
	
	return

try:
	st.set_page_config(page_title="Mercitalia - Automazione LDV / RDS", page_icon=os.path.join('images','favicon.ico'), layout="wide", menu_items=None)
	st.title("Conversione di codici internazionali a codici Mercitalia")
	st.sidebar.image(os.path.join('images','mercitalia.png'), use_column_width=True)
	load_dotenv()

	import streamlit_authenticator as stauth	
	import yaml
	from yaml.loader import SafeLoader

	with open('config.yaml') as file:
		config = yaml.load(file, Loader=SafeLoader)

	authenticator = stauth.Authenticate(
		config['credentials'],
		config['cookie']['name'],
		config['cookie']['key'],
		config['cookie']['expiry_days'],
		config['preauthorized']
	)

	if st.session_state["authentication_status"]:		
		st.image(os.path.join('images','Slide5.JPG'), use_column_width=True)
		st.write("""
### Descrizione
In questa fase il sistema effettua un **controllo sui dati relativi ai campi "mittente" e "destinatario"**, estratti dalla CIM ed anche eventualmente catturati da Orfeus: **il sistema consente all’utente di selezionare i corrispondenti codici cliente**, reperiti a partire dal database Mercitalia relativo all’anagrafica clienti, effettuando una ricerca "fuzzy" sulla similarità della ragione sociale.
### Componenti utilizzati
- **Azure App Service**: Web Container che ospita una applicazione Python che organizza tutta la logica applicativa. La ricerca tra i file di Orfeus è effettuata mediante tradizionale ricerca XML di libreria
- **Azure Blob Storage**: Servizio di storage per file/blob ad alta scalabilità per la lettura dei file di Orfeus e dei file di codifica Clienti Mercitalia
""")
		rag_soc_mittente_stream = st.container()
		rag_soc_destinatario_stream = st.container()
		similarity(st.session_state['box-01-orfeus'], rag_soc_mittente_stream)
		similarity(st.session_state['box-04-orfeus'], rag_soc_destinatario_stream)
		# import pandas as pd
		# from fuzzywuzzy import process
		# from dotenv import load_dotenv

		# # Carica i dati da un file Excel
		# excel_path = os.path.join('ldv', 'clienti.xlsx')
		# df = pd.read_excel(excel_path)

		# # Trova la corrispondenza più simile nel DataFrame
		# corrispondenze1 = process.extract(st.session_state['box-01-orfeus'], df['ragione sociale'], limit=5)
		# options1 = []

		# # Stampa le corrispondenze trovate e i relativi codici
		# for corrispondenza in corrispondenze1:
		# 	match = corrispondenza[0]  # La ragione sociale corrispondente
		# 	score = corrispondenza[1]  # Il punteggio di similarità

		# 	# Trova l'indice (o gli indici) nel DataFrame dove c'è questa corrispondenza
		# 	indici = df.index[df['ragione sociale'] == match].tolist()

		# 	# Stampa i dettagli delle corrispondenze trovate

		# 	for indice in indici:
		# 		codice_corrispondente = df.loc[indice, 'codice']
		# 		options1.append(f"{match} - Codice: {codice_corrispondente}, Similarità: {score}")

		# st.write(f"Ricerca mittente: {st.session_state['box-01-orfeus']}")
		# st.selectbox("Mittente (Ragioni sociali simili)", options1, placeholder="Seleziona la corrispondenza più simile", key="mittente_scelto")
  
		# # Trova la corrispondenza più simile nel DataFrame
		# corrispondenze2 = process.extract(st.session_state['box-04-orfeus'], df['ragione sociale'], limit=5)
		# options2 = []
		# # Stampa le corrispondenze trovate e i relativi codici
		# for corrispondenza in corrispondenze2:
		# 	match = corrispondenza[0]  # La ragione sociale corrispondente
		# 	score = corrispondenza[1]  # Il punteggio di similarità

		# 	# Trova l'indice (o gli indici) nel DataFrame dove c'è questa corrispondenza
		# 	indici = df.index[df['ragione sociale'] == match].tolist()

		# 	# Stampa i dettagli delle corrispondenze trovate
			
		# 	for indice in indici:
		# 		codice_corrispondente = df.loc[indice, 'codice']
		# 		options2.append(f"{match} - Codice: {codice_corrispondente}, Similarità: {score}")
    
		# st.write(f"Ricerca mittente: {st.session_state['box-04-orfeus']}")
		# st.selectbox("Destinatario (Ragioni sociali simili)", options2, placeholder="Seleziona la corrispondenza più simile", key="destinatario_scelto")

		if st.button("Conferma i valori"):
			# st.session_state['box-03-selected'] = st.session_state['mittente_scelto'].split(" - Codice: ")[1].split(", Similarità: ")[0]
			# st.session_state['box-06-selected'] = st.session_state['mittente_scelto'].split(" - Codice: ")[1].split(", Similarità: ")[0]
			st.toast("Valori confermati. E' possibile procedere con la fase successiva")
  
	elif st.session_state["authentication_status"] is False:
		st.error('Username/password is incorrect')
	elif st.session_state["authentication_status"] is None:
		st.warning('Please enter your username and password')

except Exception as e:
	st.error(traceback.format_exc())

	